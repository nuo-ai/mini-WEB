__wxCodeSpace__.batchAddCompiledTemplate(function(G,R,D,Q,gdc,X,Y,Z,RG={}){var P=RG.P||function(a){return typeof a==='function'?a:()=>{}};return {'miniprogram_npm/weui-miniprogram/uploader/uploader':(()=>{var H={};var S;var I=(P)=>{if(!S)S=Object.assign({},H);return S[P]};H[""]=(R,C,D,U)=>{var L=R.c,M=R.m,O=R.r,A={"showDelete":new Array(1),"previewCurrent":new Array(1),"previewImageUrls":new Array(1),"extClass":new Array(1),"showPreview":new Array(1),"title":new Array(1)},K=U===true,e=(C,T)=>{C||K||U.title?T(Y(D.title),(N)=>{A["title"][0]=(D,E,T)=>{T(N,Y(D.title))}}):T()},f,h=(C,T)=>{C||K||!!(Z(U.currentFiles,"length")||U.maxCount)||undefined?T(Y(Y(X(D.currentFiles).length)+"/"+Y(D.maxCount))):T()},g=(C,T,E)=>{if(f===1){E("view",{},(N,C)=>{if(C)L(N,"weui-uploader__info")},h)}},d=(C,T,E,B)=>{E("view",{},(N,C)=>{if(C)L(N,"weui-uploader__title")},e);f=D.maxCount>1?1:0;B(f,g)},i,k=(C,T)=>{C||K||U.tips?T(Y(D.tips)):T()},l=(C,T,E,B,F,S)=>{S("tips")},j=(C,T,E)=>{if(i===1){E("view",{},(N,C)=>{if(C)L(N,"weui-uploader__tips")},k)}else{E("view",{},(N,C)=>{},l)}},c=(C,T,E,B)=>{E("view",{},(N,C)=>{if(C)L(N,"weui-uploader__overview")},d);i=D.tips?1:0;B(i,j)},o=(C,p,q,r,s,t,T,E,B)=>{var u,x=(C)=>{},z=(C)=>{},y=(C,T,E)=>{E("icon",{},(N,C)=>{if(C)O(N,"type","warn");if(C)O(N,"size","23");if(C)O(N,"color","#F43530")},z)},w=(C,T,E)=>{E("image",{},(N,C)=>{if(C)L(N,"weui-uploader__img");if(C||K||Z(r,"url"))O(N,"src",X(p).url);if(C)O(N,"mode","aspectFill")},x);E("view",{},(N,C)=>{if(C)L(N,"weui-uploader__file-content")},y)},B0=(C)=>{},D0=(C)=>{},C0=(C,T,E)=>{E("view",{},(N,C)=>{if(C)L(N,"weui-loading")},D0)},A0=(C,T,E)=>{E("image",{},(N,C)=>{if(C)L(N,"weui-uploader__img");if(C||K||Z(r,"url"))O(N,"src",X(p).url);if(C)O(N,"mode","aspectFill")},B0);E("view",{},(N,C)=>{if(C)L(N,"weui-uploader__file-content")},C0)},F0=(C)=>{},E0=(C,T,E)=>{E("image",{},(N,C)=>{if(C)L(N,"weui-uploader__img");if(C||K||Z(r,"url"))O(N,"src",X(p).url);if(C)O(N,"mode","aspectFill")},F0)},v=(C,T,E)=>{if(u===1){E("view",{},(N,C)=>{if(C)L(N,"weui-uploader__file weui-uploader__file_status");if(C)O(N,"bindtap","previewImage");if(C||K||s)R.d(N,"index",q)},w)}else if(u===2){E("view",{},(N,C)=>{if(C)L(N,"weui-uploader__file weui-uploader__file_status");if(C)O(N,"bindtap","previewImage");if(C||K||s)R.d(N,"index",q)},A0)}else{E("view",{},(N,C)=>{if(C)L(N,"weui-uploader__file");if(C)O(N,"bindtap","previewImage");if(C||K||s)R.d(N,"index",q)},E0)}};u=X(p).error?1:X(p).loading?2:0;B(u,v)},n=(C,T,E,B,F)=>{F(D.currentFiles,"*this",U?U.currentFiles:undefined,[0,"currentFiles"],o)},p,s=(C)=>{},r=(C,T,E)=>{E("view",{},(N,C)=>{if(C)L(N,"weui-uploader__input");if(C)O(N,"bindtap","chooseImage")},s)},q=(C,T,E)=>{if(p===1){E("view",{},(N,C)=>{if(C)L(N,"weui-uploader__input-box");if(C)O(N,"hover-class","weui-active")},r)}},m=(C,T,E,B)=>{E("view",{},(N,C)=>{if(C)L(N,"weui-uploader__files")},n);p=X(D.currentFiles).length<D.maxCount?1:0;B(p,q)},b=(C,T,E)=>{E("view",{},(N,C)=>{if(C)L(N,"weui-uploader__hd")},c);E("view",{},(N,C)=>{if(C)L(N,"weui-uploader__bd")},m)},t=(C)=>{},a=(C,T,E)=>{E("view",{},(N,C)=>{if(C||K||!!U.extClass||undefined)L(N,"weui-uploader "+Y(D.extClass));A["extClass"][0]=(D,E,T)=>{L(N,"weui-uploader "+Y(D.extClass))}},b);E("mp-gallery",{},(N,C)=>{if(C)L(N,"gallery");if(C||K||undefined)O(N,"hide-on-click",true);if(C||K||U.showDelete)O(N,"show-delete",D.showDelete);A["showDelete"][0]=(D,E,T)=>{O(N,"show-delete",D.showDelete);E(N)};if(C||K||U.showPreview)O(N,"show",D.showPreview);A["showPreview"][0]=(D,E,T)=>{O(N,"show",D.showPreview);E(N)};if(C)O(N,"binddelete","deletePic");if(C||K||U.previewImageUrls)O(N,"img-urls",D.previewImageUrls);A["previewImageUrls"][0]=(D,E,T)=>{O(N,"img-urls",D.previewImageUrls);E(N)};if(C||K||U.previewCurrent)O(N,"current",D.previewCurrent);A["previewCurrent"][0]=(D,E,T)=>{O(N,"current",D.previewCurrent);E(N)}},t)};;return {C:a,B:A}};return Object.assign(function(R){return H[R]},{_:H})})(),}});;__wxRoute = "miniprogram_npm/weui-miniprogram/uploader/uploader";__wxRouteBegin = true;__wxAppCurrentFile__="miniprogram_npm/weui-miniprogram/uploader/uploader.js";define("miniprogram_npm/weui-miniprogram/uploader/uploader.js",function(require,module,exports,window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){
"use strict";module.exports=require("../_commons/0.js")([{ids:[23],modules:{169:function(e,t){Component({options:{},properties:{title:{type:String,value:"图片上传"},sizeType:{type:Array,value:["original","compressed"]},sourceType:{type:Array,value:["album","camera"]},maxSize:{type:Number,value:5242880},maxCount:{type:Number,value:1},files:{type:Array,value:[],observer:function(e){this.setData({currentFiles:e})}},select:{type:null,value:function(){}},upload:{type:null,value:null},tips:{type:String,value:""},extClass:{type:String,value:""},showDelete:{type:Boolean,value:!0}},data:{currentFiles:[],showPreview:!1,previewImageUrls:[]},ready:function(){},methods:{previewImage:function(e){var t=e.currentTarget.dataset.index,a=[];this.data.files.forEach((function(e){a.push(e.url)})),this.setData({previewImageUrls:a,previewCurrent:t,showPreview:!0})},chooseImage:function(){var e=this;this.uploading||wx.chooseImage({count:this.data.maxCount-this.data.files.length,sizeType:this.data.sizeType,sourceType:this.data.sourceType,success:function(t){console.log("chooseImage resp",t);var a=-1;if(t.tempFiles.forEach((function(t,i){t.size>e.data.maxSize&&(a=i)})),console.log("this.data.select: ".concat(e.data.select)),"function"!=typeof e.data.select||!1!==e.data.select(t))if(a>=0)e.triggerEvent("fail",{type:1,errMsg:"chooseImage:fail size exceed ".concat(e.data.maxSize),total:t.tempFilePaths.length,index:a},{});else{var i=wx.getFileSystemManager(),s=t.tempFilePaths.map((function(e){return i.readFileSync(e)})),l={tempFilePaths:t.tempFilePaths,tempFiles:t.tempFiles,contents:s};e.triggerEvent("select",l,{});var r=t.tempFilePaths.map((function(e,a){return{loading:!0,url:t.tempFilePaths[a]||"data:image/jpg;base64,".concat(wx.arrayBufferToBase64(s[a]))}}));if(r&&r.length&&"function"==typeof e.data.upload){var n=e.data.files.length,o=e.data.files.concat(r);e.setData({files:o,currentFiles:o}),e.loading=!0,e.data.upload(l).then((function(t){if(console.log("------",t),e.loading=!1,t.urls){var a=e.data.files;t.urls.forEach((function(e,t){a[n+t].url=e,a[n+t].loading=!1})),e.setData({files:a,currentFiles:o}),e.triggerEvent("success",t,{})}else e.triggerEvent("fail",{type:3,errMsg:"upload file fail, urls not found"},{})})).catch((function(a){console.log("------catch",a),e.loading=!1;var i=e.data.files;t.tempFilePaths.forEach((function(e,t){i[n+t].error=!0,i[n+t].loading=!1})),e.setData({files:i,currentFiles:o}),e.triggerEvent("fail",{type:3,errMsg:"upload file fail",error:a},{})}))}}},fail:function(t){t.errMsg.indexOf("chooseImage:fail cancel")>=0?e.triggerEvent("cancel",{},{}):(t.type=2,e.triggerEvent("fail",t,{}))}})},deletePic:function(e){var t=e.detail.index,a=this.data.files,i=a.splice(t,1);this.setData({files:a,currentFiles:a}),this.triggerEvent("delete",{index:t,item:i[0]})}}})},18:function(e,t,a){e.exports=a(169)}},entries:[[18,0]]}]);
},{isPage:false,isComponent:true,currentFile:'miniprogram_npm/weui-miniprogram/uploader/uploader.js'});require("miniprogram_npm/weui-miniprogram/uploader/uploader.js");