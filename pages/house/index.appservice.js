__wxCodeSpace__.batchAddCompiledTemplate(function(G,R,D,Q,gdc,X,Y,Z,RG={}){var P=RG.P||function(a){return typeof a==='function'?a:()=>{}};return {'pages/house/index':(()=>{var H={};var S;var I=(P)=>{if(!S)S=Object.assign({},H);return S[P]};H[""]=(R,C,D,U)=>{var L=R.c,M=R.m,O=R.r,A={"requesting":new Array(1),"toggle":new Array(1),"descs":new Array(1),"operation_name":new Array(1)},K=U===true,d=(C,T)=>{C||K||Z(U.detail,"page_title")?T(Y(X(D.detail).page_title)):T()},c=(C,T,E)=>{E("view",{},(N,C)=>{},d)},f,h=(C)=>{},g=(C,T,E)=>{if(f===1){E("view",{},(N,C)=>{if(C)L(N,"restrict-area__mask");if(C)O(N,"bindtap","preview")},h)}},i=(C)=>{},e=(C,T,E,B)=>{f=!D.ifLogged?1:0;B(f,g);E("house-info-gallery",{},(N,C)=>{if(C||K||Z(Z(U.detail,"house"),"photo"))O(N,"photo",X(X(D.detail).house).photo);if(C||K||Z(Z(U.detail,"house"),"photos"))O(N,"photos",X(X(D.detail).house).photos)},i)},k,m=(C)=>{},l=(C,T,E)=>{if(k===1){E("image",{},(N,C)=>{if(C)L(N,"house-video card");if(C)O(N,"mode","aspectFit");if(C)O(N,"src","/assets/icons/circle-play-sharp-solid.svg");if(C)O(N,"bindtap","play")},m)}},o,r=(C)=>{},t=(C)=>{},u=(C)=>{},s=(C,T,E)=>{E("house-info-title",{},(N,C)=>{if(C||K||Z(U.detail,"house"))O(N,"house",X(D.detail).house);if(C||K||Z(U.detail,"page_title"))O(N,"title",X(D.detail).page_title);if(C)R.v(N,"play","play",!1,!1,!1,!1)},t);E("house-info-location",{},(N,C)=>{if(C||K||Z(U.detail,"house"))O(N,"house",X(D.detail).house);if(C||K||Z(U.detail,"page_title"))O(N,"title",X(D.detail).page_title)},u)},w=(C,T)=>{C||K||Z(Z(U.detail,"house"),"content")?T(Y(X(X(D.detail).house).content)):T()},v=(C,T,E)=>{E("text",{},(N,C)=>{if(C)O(N,"user-select",true)},w)},q=(C,T,E)=>{E("seek-banner",{},(N,C)=>{},r);E("view",{},(N,C)=>{if(C)L(N,"house-title")},s);E("view",{},(N,C)=>{if(C)L(N,"house-content context")},v)},p=(C,T,E)=>{if(o===1){E("view",{},(N,C)=>{if(C)L(N,"house-container")},q)}},n=(C,T,E,B)=>{o=D.detail?1:0;B(o,p)},j=(C,T,E,B)=>{k=X(X(D.detail).house).video?1:0;B(k,l);E("scroll-view",{},(N,C)=>{if(C)L(N,"scroll-content");if(C||K||undefined)O(N,"enable-passive",true);if(C||K||undefined)O(N,"scroll-y",true);if(C||K||undefined)O(N,"enhanced",true);if(C||K||undefined)O(N,"show-scrollbar",false);if(C||K||undefined)O(N,"refresher-enabled",true);if(C)O(N,"bindrefresherrefresh","init");if(C||K||U.requesting)O(N,"refresher-triggered",D.requesting);A["requesting"][0]=(D,E,T)=>{O(N,"refresher-triggered",D.requesting);E(N)}},n)},y,A0=(C,T)=>{var $A=X(X(D.detail).house).house_type==2;C||K||!!(Z(Z(U.detail,"house"),"house_type")||($A?undefined:undefined))||undefined?T(Y("我要"+Y($A?"卖房":"出租"))):T()},z=(C,T,E)=>{if(y===1){E("view",{},(N,C)=>{if(C)L(N,"form-button house-operation__publish");if(C)O(N,"bindtap","create")},A0)}},B0,E0=(C,T)=>{C?T("分享"):T()},F0=(C,T)=>{var $A=X(D.detail).is_follow;C||K||!!(Z(U.detail,"is_follow")||($A?undefined:undefined))||undefined?T(Y(Y($A?"已收藏":"收藏")+" ")):T()},G0=(C,T)=>{C?T("联系"):T()},H0=(C,T)=>{C?T("私信"):T()},D0=(C,T,E)=>{E("button",{},(N,C)=>{if(C)L(N,"house-operation__btn_item");if(C)O(N,"open-type","share")},E0);E("view",{},(N,C)=>{var $A=X(D.detail).is_follow;if(C||K||!!(Z(U.detail,"is_follow")||($A?undefined:undefined))||undefined)L(N,"house-operation__btn_item "+Y($A?"active":""));if(C)O(N,"bindtap","favor")},F0);E("view",{},(N,C)=>{if(C)L(N,"house-operation__btn_item");if(C)O(N,"bindtap","contact")},G0);E("view",{},(N,C)=>{if(C)L(N,"house-operation__btn_item");if(C)O(N,"bindtap","chat")},H0)},C0=(C,T,E)=>{if(B0===1){E("view",{},(N,C)=>{if(C)L(N,"house-operation__btn")},D0)}},I0,L0=(C,T)=>{C?T("删除"):T()},M0=(C,T)=>{C?T("编辑"):T()},K0=(C,T,E)=>{E("view",{},(N,C)=>{if(C)L(N,"house-operation__btn_item warning");if(C)O(N,"bindtap","remove")},L0);E("view",{},(N,C)=>{if(C)L(N,"house-operation__btn_item");if(C)O(N,"bindtap","edit")},M0)},J0=(C,T,E)=>{if(I0===1){E("view",{},(N,C)=>{if(C)L(N,"house-operation__btn")},K0)}},x=(C,T,E,B)=>{y=D.share?1:0;B(y,z);B0=!X(D.detail).is_from_liuliu&&!X(D.detail).is_myself?1:0;B(B0,C0);I0=!X(D.detail).is_from_liuliu&&X(D.detail).is_myself?1:0;B(I0,J0)},N0=(C)=>{},b=(C,T,E)=>{E("nav-bar",{},(N,C)=>{if(C||K||Z(U.detail,"page_title"))O(N,"title",X(D.detail).page_title);if(C)O(N,"mode","immersive")},c);E("view",{},(N,C)=>{if(C)L(N,"restrict-area")},e);E("view",{},(N,C)=>{if(C)L(N,"scroll-container scroll-container-tab half-screen-panel")},j);E("view",{},(N,C)=>{if(C)L(N,"house-operation card")},x);E("signin-panel",{},(N,C)=>{if(C||K||U.toggle)O(N,"show",D.toggle);A["toggle"][0]=(D,E,T)=>{O(N,"show",D.toggle);E(N)};var $A=D.operation_name;if(C||K||!!U.operation_name||Z(U.descs,$A))O(N,"desc",X(D.descs)[$A]);A["descs"][0]=A["operation_name"][0]=(D,E,T)=>{var $B=D.operation_name;O(N,"desc",X(D.descs)[$B]);E(N)};if(C)R.v(N,"login","confirm",!1,!1,!1,!1);if(C)R.v(N,"quit","clear",!1,!1,!1,!1)},N0)},a=(C,T,E)=>{E("view",{},(N,C)=>{if(C)L(N,"container container-flex")},b)};;return {C:a,B:A}};return Object.assign(function(R){return H[R]},{_:H})})(),}});;__wxRoute = "pages/house/index";__wxRouteBegin = true;__wxAppCurrentFile__="pages/house/index.js";define("pages/house/index.js",function(require,module,exports,window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){
"use strict";var t=require("../../@babel/runtime/helpers/objectSpread2"),a=d(require("../../6EFD26C485E1369C089B4EC348622695.js")),e=d(require("../../737EDC9385E1369C1518B494D3412695.js")),i=d(require("../../EA0DCCC285E1369C8C6BA4C5DCE02695.js")),n=d(require("../../A2D8119185E1369CC4BE7996A3312695.js")),s=require("../../0CB3296685E1369C6AD5416181F12695.js"),o=require("../../5C9CDA9585E1369C3AFAB292CA022695.js");function d(t){return t&&t.__esModule?t:{default:t}}Page({behaviors:[e.default,i.default,n.default],data:{id:"",type:"",from:"",requesting:!1,detail:null,operation_name:"",descs:{favor:"收藏该房源",preview:"查看房源照片",play:"观看房源视频",contact:"联系房东",chat:"给房东发送私信"},binding:!1,share:!1},onShow:function(){this.syncLoggingState(),this.configShareMenu(),this.getShareInfo(2==this.data.type?{sale_id:this.data.id,share_uid:this.data.from}:{house_id:this.data.id,share_uid:this.data.from})},onLoad:function(t){this.setData({id:t.id,type:t.type,from:t.from?t.from:"",share:getCurrentPages().length<=1}),this.init()},init:function(){var a=this;this.data.requesting||(this.data.detail||this.setData({requesting:!0}),(2==this.data.type?o.viewSaleDetail:s.viewHouseDetail)({data:2==this.data.type?{sale_id:this.data.id,from_uid:this.data.from}:{house_id:this.data.id,from_uid:this.data.from},success:function(e){a.setData({requesting:!1,detail:t(t({},e),{},{house:e.sale?e.sale:e.house})})},fail:function(){wx.switchTab({url:"/pages/index/index"})}}))},bind:function(){this.setData({binding:!this.data.binding})},confirm:function(){this.close(),this.init(),this["".concat(this.data.operation_name)]()},preview:function(){var t=this,a=this;this.setData({operation_name:"preview"}),this.handle((function(){a.browse(0,t.data.detail.house.photos)}))},play:function(){var t=this,a=this;this.setData({operation_name:"play"}),this.handle((function(){a.playVideo(t.data.detail.house.video)}))},contact:function(){var t=this;this.setData({operation_name:"contact"}),this.handle((function(){t.communicate()}))},communicate:function(){(0,s.askHouseContact)({data:{id:this.data.id,type:this.data.type},success:function(t){wx.showModal({title:"联系方式",content:t,confirmText:"点击复制",confirmColor:"#08979C",success:function(a){a.confirm&&wx.setClipboardData({data:t})}})},fail:function(t){wx.showModal({title:"积分不足",content:"无法查看联系方式",confirmText:"获取积分",confirmColor:"#08979C",cancelText:"关闭",success:function(t){t.confirm&&wx.navigateTo({url:"/pages/bonus/index"})}})}})},favor:function(){var t=this;this.setData({operation_name:"favor"}),this.handle((function(){t.collect()}))},collect:function(){var t=this;(0,s.updateFollowState)({data:{id:this.data.id,house_type:this.data.type,is_follow:this.data.detail.is_follow},success:function(){t.init()}})},chat:function(){var t=this;this.setData({operation_name:"chat"}),this.handle((function(){wx.navigateTo({url:"/pages/reply/index?house_id=".concat(t.data.id,"&house_type=").concat(t.data.type,"&username=").concat(t.data.detail.user.username,"&title=").concat(t.data.detail.message_title,"&avatar=").concat(t.data.detail.user.avatar.src)})}))},create:function(){wx.navigateTo({url:"/pages/editor/index?type=".concat(this.data.type)})},edit:function(){wx.navigateTo({url:"/pages/editor/index?id=".concat(this.data.id,"&type=").concat(this.data.type)})},remove:function(){var t=this;wx.showModal({title:"删除房源",content:"确定要删除该房源吗？",success:function(a){a.confirm&&(0,s.removeHouse)({data:t.data.id,success:function(){wx.navigateBack()}})}})},onShareAppMessage:function(){var t=a.default.getToken("uid");return{title:this.data.detail.house.share.title,path:"/pages/house/index?id=".concat(this.data.id,"&type=").concat(this.data.type,"&from=").concat(t),imageUrl:this.data.detail.house.share.photo.small}},onShareTimeline:function(){var t=a.default.getToken("uid");return{title:this.data.detail.house.share.title,query:"id=".concat(this.data.id,"&type=").concat(this.data.type,"&from=").concat(t),imageUrl:this.data.detail.house.share.photo.small}}});
},{isPage:true,isComponent:true,currentFile:'pages/house/index.js'});require("pages/house/index.js");