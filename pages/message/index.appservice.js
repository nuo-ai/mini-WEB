__wxCodeSpace__.batchAddCompiledTemplate(function(G,R,D,Q,gdc,X,Y,Z,RG={}){var P=RG.P||function(a){return typeof a==='function'?a:()=>{}};return {'pages/message/index':(()=>{var H={};var S;var I=(P)=>{if(!S)S=Object.assign({},(G["pages/message/index.skeleton"]||{})._,H);return S[P]};H[""]=(R,C,D,U)=>{var L=R.c,M=R.m,O=R.r,A={},K=U===true,b,d,e=(C,T,E,B,F,S,J)=>{var $A=I(d);if(d&&$A)$A(R,C,"",Object.create(null)).C(C,T,E,B,F,S,J)},h=(C,T)=>{var $A=D.from=="send";C||K||!!U.from||($A?undefined:undefined)?T(Y($A?"已发送":"消息")):T()},g=(C,T,E)=>{E("view",{},(N,C)=>{},h)},i,k=(C,T)=>{C||K||Z(Z(U.detail,"house"),"title")?T(Y(X(X(D.detail).house).title)):T()},l=(C,T)=>{C||K||Z(Z(U.detail,"topic"),"title")?T(Y(X(X(D.detail).topic).title)):T()},m=(C,T)=>{C||K||Z(Z(U.detail,"demand"),"title")?T(Y(X(X(D.detail).demand).title)):T()},j=(C,T,E)=>{if(i===1){E("view",{},(N,C)=>{if(C)L(N,"banner");if(C)O(N,"bindtap","view")},k)}else if(i===2){E("view",{},(N,C)=>{if(C)L(N,"banner");if(C)O(N,"bindtap","view")},l)}else if(i===3){E("view",{},(N,C)=>{if(C)L(N,"banner");if(C)O(N,"bindtap","view")},m)}},n,r=(C)=>{},s,v=(C)=>{},w=(C)=>{},x=(C)=>{},u=(C,T,E)=>{E("view",{},(N,C)=>{if(C)L(N,"message-separate__line")},v);E("image",{},(N,C)=>{if(C)L(N,"message-separate__icon");if(C)O(N,"src","/assets/icons/reply-light.svg");if(C)O(N,"mode","aspectFit")},w);E("view",{},(N,C)=>{if(C)L(N,"message-separate__line")},x)},t=(C,T,E)=>{if(s===1){E("view",{},(N,C)=>{if(C)L(N,"message-separate")},u)}},y,A0=(C)=>{},z=(C,T,E)=>{if(y===1){E("message-item",{},(N,C)=>{if(C||K||Z(U.detail,"receive"))O(N,"conversation",X(D.detail).receive)},A0)}},q=(C,T,E,B)=>{E("message-item",{},(N,C)=>{if(C||K||Z(U.detail,"send"))O(N,"conversation",X(D.detail).send)},r);s=X(D.detail).receive?1:0;B(s,t);y=X(D.detail).receive?1:0;B(y,z)},p=(C,T,E)=>{E("scroll-view",{},(N,C)=>{if(C)L(N,"scroll-content");if(C||K||undefined)O(N,"enable-passive",true);if(C||K||undefined)O(N,"scroll-y",true);if(C||K||undefined)O(N,"enhanced",true);if(C||K||undefined)O(N,"show-scrollbar",false)},q)},o=(C,T,E)=>{if(n===1){E("view",{},(N,C)=>{var $A=X(D.detail).can_reply;if(C||K||!!(Z(U.detail,"can_reply")||($A?undefined:undefined))||undefined)L(N,"scroll-container "+Y($A?"reply-container":""))},p)}},B0,F0=(C)=>{},H0=(C,T)=>{C?T("回复"):T()},G0=(C,T,E)=>{E("view",{},(N,C)=>{if(C)R.y(N,"flex:1")},H0)},E0=(C,T,E)=>{E("textarea",{},(N,C)=>{if(C)L(N,"operation-container__input");if(C||K||U.message)O(N,"value",D.message);if(C)O(N,"bindinput","write");if(C||K||undefined)O(N,"adjust-position",false);if(C)O(N,"adjust-keyboard-to","bottom");if(C||K||undefined)O(N,"auto-height",true);if(C)O(N,"placeholder","请填写回复内容");if(C)O(N,"maxlength","300");if(C)O(N,"bindkeyboardheightchange","adjust")},F0);E("view",{},(N,C)=>{if(C)L(N,"operation-container__reply");if(C)O(N,"bindtap","reply")},G0)},D0=(C,T,E)=>{E("view",{},(N,C)=>{if(C)L(N,"reply-operation-container")},E0)},J0=(C,T)=>{C?T("对方回复时，我们可以第一时间通知您"):T()},L0=(C,T)=>{C?T("订阅回复通知"):T()},K0=(C,T,E)=>{E("view",{},(N,C)=>{if(C)L(N,"operation-container__btn message");if(C)O(N,"bindtap","notify")},L0)},I0=(C,T,E)=>{E("view",{},(N,C)=>{if(C)L(N,"operation-intro")},J0);E("view",{},(N,C)=>{if(C)L(N,"operation-container")},K0)},C0=(C,T,E)=>{if(B0===1){E("view",{},(N,C)=>{if(C)L(N,"reply-operation");if(C||K||!!(U.keyboard_height||U.keyboard_duration)||undefined)R.y(N,"bottom:"+Y(D.keyboard_height)+"px;transition:all ease "+Y(D.keyboard_duration)+"s")},D0)}else if(B0===2){E("view",{},(N,C)=>{if(C)L(N,"footer-operation")},I0)}},M0=(C)=>{},f=(C,T,E,B)=>{E("nav-bar",{},(N,C)=>{if(C)O(N,"title","消息");if(C)O(N,"backtab","inbox")},g);i=X(D.detail).house?1:X(D.detail).topic?2:X(D.detail).demand?3:0;B(i,j);n=D.detail?1:0;B(n,o);B0=X(D.detail).can_reply?1:D.from=="send"?2:0;B(B0,C0);E("signin-panel",{},(N,C)=>{if(C||K||U.toggle)O(N,"show",D.toggle);if(C)R.v(N,"login","confirm",!1,!1,!1,!1);if(C)R.v(N,"quit","cancel",!1,!1,!1,!1)},M0)},c=(C,T,E,B,F,S,J)=>{if(b===1){d="skeleton";B(d,e)}else{E("view",{},(N,C)=>{if(C)L(N,"container container-flex")},f)}},a=(C,T,E,B)=>{b=!D.detail&&D.ifLogged?1:0;B(b,c)};;return {C:a,B:A}};return Object.assign(function(R){return H[R]},{_:H})})(),}});;__wxRoute = "pages/message/index";__wxRouteBegin = true;__wxAppCurrentFile__="pages/message/index.js";define("pages/message/index.js",function(require,module,exports,window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){
"use strict";var t=require("../../1BC4768185E1369C7DA21E86DDF12695.js"),a=d(require("../../3D2B1CF485E1369C5B4D74F3AC012695.js")),i=d(require("../../737EDC9385E1369C1518B494D3412695.js")),e=d(require("../../6EFD26C485E1369C089B4EC348622695.js"));function d(t){return t&&t.__esModule?t:{default:t}}Page({behaviors:[a.default,i.default],data:{parent_id:"",from:"",detail:null,keyboard_height:0,keyboard_duration:0},onLoad:function(t){var a=this;this.setData({parent_id:t.id,from:t.from?t.from:""}),this.handle((function(){a.init()}))},confirm:function(){this.setData({toggle:!1}),this.init()},cancel:function(){this.clear(),wx.switchTab({url:"/pages/inbox/index"})},init:function(){var a=this;(0,t.viewMessageDetail)({data:this.data.parent_id,success:function(t){a.setData({detail:t})},fail:function(){wx.switchTab({url:"/pages/inbox/index"})}})},view:function(){"send"==this.data.from?wx.navigateBack({delta:2}):this.data.detail.house?wx.navigateTo({url:"/pages/house/index?id=".concat(this.data.detail.house.id,"&type=").concat(this.data.detail.house.house_type)}):this.data.detail.topic?wx.navigateTo({url:"/pages/topic/index?id=".concat(this.data.detail.topic.id)}):this.data.detail.demand&&wx.navigateTo({url:"/pages/demand/index?id=".concat(this.data.detail.demand.id)})},reply:function(){var t=this;wx.showModal({title:"提示",content:"此消息只能回复一次，确认回复？",confirmText:"确认回复",confirmColor:"#08979C",success:function(a){a.confirm&&t.send((function(){t.init()}))}})},rereply:function(){var t=e.default.getToken("uid"),a=this.data.detail.receive,i=this.data.detail.send,d=a.from_user.id==t?i:a,n=this.data.detail.demand?this.data.detail.demand:this.data.detail.house?this.data.detail.house:this.data.detail.topic,s="";this.data.detail.house?s="&".concat(2==n.house_type?"sale_id":"house_id","=").concat(n.id,"&house_type=").concat(n.house_type):this.data.detail.topic?s="&topic_id=".concat(n.id):this.data.detail.demand&&(s="&demand_id=".concat(n.id)),wx.navigateTo({url:"/pages/reply/index?title=".concat(n.title,"&username=").concat(d.from_user.username,"&avatar=").concat(d.from_user.avatar.src).concat(s)})},adjust:function(t){var a=t.detail.height,i=t.detail.duration;this.setData({keyboard_height:a,duration:i})},notify:function(){wx.navigateTo({url:"/pages/subscribe/index"})}});
},{isPage:true,isComponent:true,currentFile:'pages/message/index.js'});require("pages/message/index.js");